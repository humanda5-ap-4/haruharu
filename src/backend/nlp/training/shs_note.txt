í›Œë¥­í•œ UX ì•„ì´ë””ì–´ì˜ˆìš”! ğŸ‘
ë‹¹ì‹ ì´ ì›í•˜ëŠ” ê±´:

âœ… ì±—ë´‡ í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì‚¬ìš©ì ë©”ì‹œì§€ì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´,
ì˜†ì— "í•™ìŠµë°ì´í„°ì— ë„£ê¸°" ë²„íŠ¼ì´ ë– ì„œ í´ë¦­ ì‹œ ë°±ì—”ë“œë¡œ ì „ì†¡ë˜ì–´ ì €ì¥ë˜ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤.

ğŸ§© êµ¬í˜„ êµ¬ì„± ìš”ì•½
ğŸ“ í”„ë¡ íŠ¸ì—”ë“œ (React ë˜ëŠ” Vue ê¸°ë°˜ìœ¼ë¡œ ì„¤ëª…)
ì‚¬ìš©ì ë©”ì‹œì§€ ì»´í¬ë„ŒíŠ¸ì— hover ì´ë²¤íŠ¸ ì¶”ê°€

hover ì‹œ ë²„íŠ¼ UI ë…¸ì¶œ (position: absolute)

ë²„íŠ¼ í´ë¦­ ì‹œ POST /add-intent API í˜¸ì¶œ

ğŸ“ ë°±ì—”ë“œ (FastAPI ê¸°ì¤€)
POST /add-intent endpoint ìƒì„±

textì™€ intentë¥¼ ë°›ì•„ intent_dataset.jsonì— ì¶”ê°€

intent_embeddings.pkl ì¬ìƒì„± (ì„ íƒ)

function MessageBubble({ message, intent }) {
  const [hovered, setHovered] = useState(false);

  const handleAddToTraining = async () => {
    await fetch("/api/add-intent", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ text: message, intent }),
    });
    alert("ğŸ‰ í•™ìŠµ ë°ì´í„°ì— ì¶”ê°€ ì™„ë£Œ!");
  };

  return (
    <div
      className="relative group"
      onMouseEnter={() => setHovered(true)}
      onMouseLeave={() => setHovered(false)}
    >
      <div className="bg-gray-100 p-3 rounded-lg">{message}</div>

      {hovered && (
        <button
          className="absolute right-0 top-0 bg-blue-500 text-white text-xs p-1 rounded hover:bg-blue-600 transition"
          onClick={handleAddToTraining}
        >
          í•™ìŠµì— ì¶”ê°€
        </button>
      )}
    </div>
  );
}

from fastapi import FastAPI, Request
from pydantic import BaseModel
import json, pickle
from sentence_transformers import SentenceTransformer
import torch

app = FastAPI()

DATASET_PATH = "dataset/intent_dataset.json"
EMBEDDING_PATH = "intent_embeddings.pkl"
SBERT_MODEL = "jhgan/ko-sbert-sts"
model = SentenceTransformer(SBERT_MODEL)

class AddIntent(BaseModel):
    text: str
    intent: str

@app.post("/add-intent")
async def add_intent(data: AddIntent):
    # 1. ë°ì´í„°ì…‹ ì¶”ê°€
    with open(DATASET_PATH, "r", encoding="utf-8") as f:
        dataset = json.load(f)

    dataset.append({"text": data.text, "intent": data.intent})
    with open(DATASET_PATH, "w", encoding="utf-8") as f:
        json.dump(dataset, f, ensure_ascii=False, indent=2)

    # 2. ì„ë² ë”© ê°±ì‹ 
    intent_texts = {}
    for item in dataset:
        intent_texts.setdefault(item["intent"], []).append(item["text"])

    intent_embeddings = {
        intent: model.encode(texts, convert_to_tensor=True).mean(dim=0, keepdim=True)
        for intent, texts in intent_texts.items()
    }

    with open(EMBEDDING_PATH, "wb") as f:
        pickle.dump(intent_embeddings, f)

    return {"message": "âœ… í•™ìŠµ ë°ì´í„°ì— ì¶”ê°€ë¨"}
